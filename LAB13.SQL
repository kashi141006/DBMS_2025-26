
SELECT * FROM AUTHOR;
SELECT * FROM  PUBLISHER;
SELECT * FROM  BOOK;

--Part – A: 
--1. List all books with their authors. 
SELECT TITLE,AUTHORNAME
FROM BOOK
JOIN AUTHOR
ON BOOK.AUTHORID=AUTHOR.AUTHORID;
--2. List all books with their publishers. 
SELECT TITLE,PUBLISHERNAME
FROM BOOK
JOIN PUBLISHER
ON BOOK.PUBLISHERID=PUBLISHER.PUBLISHERID;
--3. List all books with their authors and publishers. 
SELECT
TITLE,
AUTHORNAME,
PUBLISHERNAME
FROM BOOK
JOIN AUTHOR
ON BOOK.AUTHORID=AUTHOR.AUTHORID
JOIN PUBLISHER
ON BOOK.PUBLISHERID=PUBLISHER.PUBLISHERID;
--4. List all books published after 2010 with their authors and publisher and price. 
SELECT TITLE,AUTHORNAME,PUBLISHERNAME,PUBLICATIONYEAR,PRICE
FROM BOOK
JOIN AUTHOR
ON BOOK.AUTHORID=AUTHOR.AUTHORID
JOIN PUBLISHER
ON BOOK.PUBLISHERID=PUBLISHER.PUBLISHERID
WHERE PUBLICATIONYEAR>2010;
--5. List all authors and the number of books they have written. 
SELECT    
    AUTHORNAME, 
    COUNT(BOOK.AUTHORID) AS TOTAL_BOOK
FROM BOOK
JOIN AUTHOR
ON BOOK.AUTHORID=AUTHOR.AUTHORID
GROUP BY AUTHORNAME
 
--6. List all publishers and the total price of books they have published. 
SELECT
    PUBLISHERNAME,
    SUM(PRICE) AS PRICE_TOATL
FROM BOOK 
JOIN PUBLISHER
ON BOOK.PUBLISHERID=PUBLISHER.PUBLISHERID
GROUP BY PUBLISHERNAME;
--7. List authors who have not written any books. 
SELECT    
    AUTHORNAME ,
    TITLE
 FROM BOOK
RIGHT OUTER JOIN AUTHOR
ON BOOK.AUTHORID=AUTHOR.AUTHORID
WHERE BOOK.BOOKID IS NULL;
 
--8. Display total number of Books and Average Price of every Author. 
SELECT    
    AUTHORNAME ,
    COUNT(BOOKID) AS TOTAL,
    AVG(PRICE) AS AVG_PRICE
 FROM BOOK
RIGHT OUTER JOIN AUTHOR
ON BOOK.AUTHORID=AUTHOR.AUTHORID
GROUP BY AUTHORNAME
 
--9. lists each publisher along with the total number of books they have published, sorted from highest to 
--lowest. 
SELECT
    PUBLISHERNAME,
    COUNT(BOOK.PUBLISHERID) AS TOTAL
FROM BOOK
RIGHT OUTER JOIN PUBLISHER
ON BOOK.PUBLISHERID=PUBLISHER.PUBLISHERID
GROUP BY PUBLISHERNAME
ORDER BY PUBLISHERNAME DESC;

--10. Display number of books published each year.
SELECT
    PUBLICATIONYEAR,
    COUNT(BOOK.PUBLISHERID) AS TOTAL
FROM BOOK
RIGHT OUTER JOIN PUBLISHER
ON BOOK.PUBLISHERID=PUBLISHER.PUBLISHERID
GROUP BY  PUBLICATIONYEAR;

 
 SELECT * FROM BOOK;
--Part – B: 
--1. List the publishers whose total book prices exceed 500, ordered by the total price. 
SELECT
    PUBLISHERNAME,
     SUM(BOOK.PRICE) AS TOTAL
FROM BOOK
 JOIN PUBLISHER
ON BOOK.PUBLISHERID=PUBLISHER.PUBLISHERID 
GROUP BY  PUBLISHERNAME
HAVING SUM(BOOK.PRICE) >500
ORDER BY  SUM(BOOK.PRICE) DESC ;
--2. List most expensive book for each author, sort it with the highest price.
 SELECT
       AUTHORNAME,
       MAX(BOOK.PRICE) AS MAX_PRICE
FROM BOOK
 JOIN AUTHOR
ON BOOK.AUTHORID=AUTHOR.AUTHORID 
GROUP BY  AUTHORNAME
ORDER BY  MAX(BOOK.PRICE) DESC ;
--PART-C
--. Emp_info(Eid, Ename, Did, Cid, Salary, Experience) 
--Dept_info(Did, Dname) 
--City_info(Cid, Cname, Did)) 
--District(Did, Dname, Sid) 
--State(Sid, Sname, Cid) 
--Country(Cid, Cname) 
--2. Insert 5 records in each table. 
--3. Display employeename, departmentname, Salary, Experience, City, District, State and country of all 
--employees. 
SELECT * FROM EMP_INFO;
 SELECT * FROM DEPT_INFO;
  SELECT * FROM CITY_INFO;
 SELECT * FROM COUNTRY;
 SELECT * FROM STATE;
 SELECT *FROM  DISTRICT;
 ALTER TABLE EMP_INFO
 ALTER COLUMN SALARY DECIMAL(6,2);


 SELECT ENAME,DEPT_INFO.DNAME,SALARY,EXPERIENCE ,CITY_INFO.CNAME,DISTRICT.DNAME,SNAME,COUNTRY.CNAME
 FROM COUNTRY
 JOIN STATE
 ON COUNTRY.CID=STATE.CID
 JOIN  DISTRICT
 ON STATE.SID=DISTRICT.SID
 JOIN CITY_INFO
 ON CITY_INFO.DID=DISTRICT.DID
 JOIN  EMP_INFO
 ON EMP_INFO.CID=CITY_INFO.CID
 JOIN DEPT_INFO
 ON DEPT_INFO.DID=EMP_INFO.DID

